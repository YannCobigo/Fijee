A mesh is a representation of an object (a volume or shape in the plane) by a finite number of simple elements. Among meshes, simplicial meshes\index{simplicial meshes} are built from simplices. A simplicial mesh is a collection of simplices, with disjoint interiors, such as the intersection of two simplices is either empty or a simplex with lower dimension. \\
The simplicial meshes are very popular for representing surfaces, volumes. They are suitable for numerical simulation. For instance, the finite element method allows the approximate solution of systems of partial differential equations ({\it c.f.} section~\ref{FEM}) using meshes. \\
The generation of realistic geometric patient models from high-resolution medical images is of great significance in many clinical and research applications. 

\newpage

%-------------------------------------------------------------------------------

\section{Mathematical background}

Voronoi diagrams are structures encoding the proximity relationships between objects. Delaunay triangulations, which are geometrically dual to Voronoi diagrams, are a classical tool of computational geometry\index{computational geometry}, in the field of mesh generation\index{mesh generation} and mesh processing due to its optimality properties.\\
We now turn to the following problem: $E$ is a set of points in the plane or space, {\it what is the best triangulation of E?} The answer this question three properties of the triangulation are particularly sought: \\

\begin {itemize}
\item the algorithm must be robust (adding or deleting a point of $E$ does not require a complete change in the triangulation);
\item the algorithm must be fast to compute;
\item the algorithm must contain a minimum of elongated triangles (slivers). \\
\end {itemize}

A sliver is a tetrahedron whose four vertices lie close to a plane and whose projection to that plane is a quadrilateral with no short edge. Such tetrahedra have a good radiusedge ratio but a very poor radius-radius ratio (ratio between circumradius and radius of largest contained sphere). Unfortunately, the latter measure typically influences the numerical conditioning of finite element methods. In order to remove slivers from our volume meshes, we use a post processing step called sliver exudation [21]. This algorithm is efficient in practice and generates almost sliver-free meshes.

%I will restrict the case of discrete surfaces, that is to say, defined from a finite number of points.

\subsection{Topological space}

Topological aproximation: it is necessary to determine a mesh topology similar to the target object. The edge of a solid object must be a subset of triangles of the mesh, homeomorphic\footnote{A homeomorphism, or topological isomorphism or bicontinuous function, is a continuous function between topological spaces that has a continuous inverse function.} itself at the edge of the object. In addition, if the object has internal partitions to separate out different areas, the mesh must represent these partitions.\\

In this section we summarize some mathematical definitions of mesh generation.

\paragraph{Definition - Topological space}\index{topological space}
{
\it A topological space is a set $\mathbb{X}$ and a system $X$ of subsets of $\mathbb{X}$ such that:
\begin{itemize}
\item  $\varnothing$, $X \in \mathbb{X}$;
\item  a union of elements of $X$ is in $\mathbb{X}$ ;
\item  a finite intersection of elements in $X$ is in $\mathbb{X}$.
\end{itemize}

$X$ is called a topology and elements of $X$ are called open set in $\mathbb{X}$. %A topological subspace ($Y$, $\mathbb{Y}$) of ($X$, $\mathbb {X}$) consists of a subset of $\mathbb{Y} \subset \mathbb{X}$ and the topology of the subspace defined by $Y = \{\mathbb{Y} \cap A, A \in X \}$
}

\paragraph{Definition - Simplex}\index{simplex}
{
\it Let $\{e_{0},~e_{1}, \dots,~ e_{n} \}$ be a set of $n+1$ linearly independent points in a Euclidean space\footnote{the concept of an Euclidean space encompasses Euclidean plane and the three-dimensional space of Euclidean geometry as spaces of dimensions 2 and 3 respectively.}\index{Euclidean space} $\mathbb{E}^{m}$ where $m \ge n \ge 0$. We call a $n$-simplex, with vertices $e_{0},~e_ {1},~\dots, e_{n}$, the hull $\sigma $ of these convex points. $n$ is the dimension of $\sigma$. The set $-1$-simplex is the empty set.
}

\paragraph{Example}
{
In $\mathbb{R}^{3}$, a $0$-simplex is a vertex, a $1$-simplex is an edge, a $2$-simplex is a triangle and a $3$-simplex is a tetrahedron.
}

\paragraph{Definition - Face}\index{face}
{
\it Let $S$ be a set of linearly independent points and $\sigma$ its convex hull. Then the convex hull $\tau$ of any subset $T$ of $S$ is a simplex subset of $\sigma$. We say that $\tau$ is a face of $\sigma$, and we write $\tau \le \sigma$.
}

\paragraph{Definition - Simplicial complex}\index{simplicial complex}
{
\it A simplicial complex $K$ is a collection of faces of a finite number of simplices, such as: if $\sigma$ is in $K$ then any face of $\sigma$ is in $K$, and if $\sigma$ and $\nu$ are in $K$ then theire intersection is a face of both $\sigma$ and $\nu$. The dimension of a simplicial complex is the size of the largest simplex.
}

In other words, a simplicial complex is a geometric object describing some topological spaces by generalizing the concept of triangulation of a surface. Such an object is presented as a graph with vertices connected by edges, which can be attached on the triangular faces.

\paragraph{Definition - Polyhedron}\index{polyhedron}
{
\it Let $K$ be a simplicial complex in $\mathbb{R}^{n}$. The union $|K|$ of all simplices of $K$ with the topology of subspace of $\mathbb{R}^{n}$ is called the polyhedron $K$.
}

\paragraph{Definition - Triangulation}\index{Triangulation}
{
\it The triangulation of a topological space $X$ is a simplicial complex $K$ whose polyhedron $|K|$ is homeomorphic to $X$. If a simplicial complex exists, we say that $X$ is triangulated.
}

\subsection{Voronoi Diagram}

The Voronoi diagram\index{Voronoi diagram}, also called {\it Dirichlet tessellation}\index{Dirichlet tessellation}, with the convex hull are a practical geometric structures. It was introduced in  $\mathbb {R}^{2}$ and $\mathbb{R}^{3}$ by the German mathematician Johann Peter Gustav Lejeune Dirichlet (1805-1859) in 1850. The Russian-Ukrainian mathematician Georgy Voronoi (1868-1908) formalized this notion in the general case in 1908.\\

Let $E$ be a Euclidean vector space and $P = \{p_{i}, 1 \le i \le n\} $ be a finite set of points of $E$.

\paragraph{Definition - Voronoi cell}
{
\it A Voronoi cell of the point $p_{i} \in P$, denoted $C_{i}$, is the set of points of $E$ the closest to $p_ {i}$ than any other point of $P$:
$$
C_{i} = \{q \in E,~\forall j \ne i~~/~~ \| qp_{i} \| \le \| qp_{j} \| \}
$$

The point $p_{i}$ associated to the cell $C_{i}$ is called the site of the cell.
}       

\paragraph{Definition - Voronoi Diagram}
{
\it A Voronoi diagram of the $P$, denoted $Vor (P)$, is the subdivision of $E$ in $C_{i}$ cells associated with points $p_{i}$ of $P$:

$
Vor (P) = \bigcup_{p_{i} \in P} C_{i}
$
}

\paragraph{Definition - vertex, edge and face of Voronoi}
{
\it Let $d$ be the dimension of $E$. The intersection of $d + 1$ Voronoi cells, if not empty, is called a Voronoi vertex. The intersection of $d$ Voronoi cells, if not empty, is called Voronoi edge. The intersection $i$ Voronoi cells, $ 2 \le i \le d - 1$, if it is not empty, is called Voronoi face.
}

\paragraph{Properties}
{
\begin {itemize}
\item A Voronoi edge separating two cells $C_{i}$ and $C_{j}$ is given by the bisection of the segment $p_{i}p_{j}$.
\item The Voronoi vertex separating three cells $C_{i}$, $C_{j}$ and $C_{k}$ is the center of the circle circumscribing the triangle with vertices $p_{i}$, $p_{j}$ and $p_{k}$.
\item A Voronoi cell, if it is bounded, is a convex polygon.
\end {itemize}
}


\subsection{Delaunay Triangulation}

Delaunay meshing is recognized as one of the most powerful techniques for generating surface and volume meshes with guaranteed quality. The notion of Delaunay triangulation was proposed in 1934 by a student of Russian mathematician Georgy Voronoi: Boris Delaunay. \\
The Delaunay triangulation of a space $E$ is defined as the geometric dual of the Voronoi diagram: there is an edge between two points $p_{i}$ and $p_{j}$ in the Delaunay triangulation if and only if their Voronoi cells $V(p_{i})$ and $V(p_{j})$ have a non-empty intersection. It yields a triangulation of the space $E$, that is to say a partition of the convex hull of $E$ into $d$-dimensional simplices (i.e. into triangles in 2D, into tetrahedra in 3D and so on). The fundamental property of the Delaunay triangulation is called the empty circle (empty sphere in 3D) property: in 2D (resp. in 3D), a triangle (resp. tetrahedron) belongs to the Delaunay triangulation if and only if its circumcircle (resp. circumsphere) does not contain any other points of $E$ in its interior. \\

\paragraph{Definition - Delaunay Triangulation}
{
\it A Delaunay triangulation of the set $P$, denoted $Del(P)$, is the dual of the Voronoi diagram of $P$: vertices of the Delaunay triangulation are the points $p_{i} \in P$, and two vertices are connected by an edge in triangulation if the corresponding Voronoi cells are adjacent.
}

\paragraph{Note:}
{
Although this definition is valid in the case of a Euclidean space $E$ of any dimension, the term triangulation refers to the case plan. In the case of $\mathbb{R}^{3}$, sometimes called Delaunay tetrahedralization.
}

\paragraph{Definition - Vertex, edge of Delaunay}
{
\it The vertices of a Delaunay triangulation are called vertices of Delaunay. If $E = \mathbb{R}^{2}$, the edges of a Delaunay triangulation is called Delaunay edges.
}

\paragraph{Properties}
{
The cercle centered on a Voronoi site and passing through the three neighboring sites $p_{i}$, $p_{j}$ and $p_{k}$ is the circumcircle of the Delaunay triangle $p_{i}p_{j}p_{k}$.
}


\paragraph{Theorem - Characterization of Delaunay triangulations}
{
\it Let $p_{i}$, $p_{j}$ and $p_{k}$ three points $P$. Then the triangle with vertices $p_{i}$, $p_{j}$ and $p_{k}$ is a triangle of the Delaunay triangulation of $P$ if and only if the circumcircle of a triangle that contains no another point of $P$.
}

\paragraph{Properties}
{
Let $p_{i}$ and $p_{j}$ two points $P$. Then $p_{i}p_{j}$ segment is an edge of the Delaunay triangulation of $P$ if and only if there is a circle passing through $p_{i}$ and $p_{j}$ such that the corresponding disc contains no other point $P$.
}

\subsection{Restricted Delaunay triangulation}

\newpage{}

%-------------------------------------------------------------------------------

\section{\FIJEE{}'s meshing process}

However, due to the lack of reliable fully-automated tools for the unstructured discretization of medical datasets, simplistic geometric models are still of wide use. \\
The simplicial meshes are good tools for the finite element method, and more generally for many computational methods for modeling physical systems. However, the creation of such meshes is sometimes problematic. Indeed, the generation of a mesh representing a continuous and appropriate form for numerical simulation or visualization, can be demanding for time and memory resources. In complicated cases, it may be impossible to generate a mesh without manual intervention to meet the needs of the calculation.\\
Similarly, in the EEG/MEG source localization problem using the boundary element method (BEM), as pointed out in [2], popular simplistic head models consisting of nested tissue layers may yield a significantly lower accuracy than realistic models featuring multiple junctions.\\


\FIJEE{} allows the electric potential mapping at the surface of the skull. This calculation is based on solving the Poisson equation with the \FEM{}. The production of the mesh used by the \FEM{} is achieved by \CGAL{}. Selecting \CGAL{} for this task was based on several criteria:


\begin{itemize}
\item \CGAL{} is distributed under a dual-license scheme. \CGAL{} can be used together with Open Source software free of charge. Using \CGAL{} in other contexts can be done by obtaining a commercial license from GeometryFactory\footnote{http://geometryfactory.com/legal-terms/}. The fundamental building blocks of \CGAL{} are under the LGPL\footnote{The Lesser General Public License (v3+) gives you the right to use and copy the code freely. It is also possible to modify the code under the condition that the resulting modification is released as source code under the LGPL with any binary distribution of your software that uses these LGPL parts.}. The higher-level algorithms are released under the GPL\footnote{The GPL (v3+) is an Open Source license that, gives you the right to use, copy and modify the code freely. If you distribute your software based on GPLed CGAL data structures, you are obliged to distribute the modifications of CGAL you made, and you are furthermore obliged to distribute the source code of your own software under the GPL.} in order to protect their commercial value.
\item sophisticated developpement in C++ language; flexible and easy to link to \FIJEE{};
\item efficient forum support;
\item large toolkit available;
\item mesh production on complexe geometry.
\end{itemize}

For the latter, \CGAL{} has two very important features used by \FIJEE{}. The first is the ability to create an implicit functions from a set of points and normals. The second is the mesh generation modularity (heterogeneous mesh size control) from the labeled volume image of the head.  It offers easy control over the size and shape of mesh tetrahedra.\\

\subsection{\FREESURFER{}}

\FREESURFER{} is a software known for the studies of \WM{} and \GM{}. \FREESURFER{} provides a detailed \WM{} and \GM{} surface meshes. \texttt{mris\_convert}, tool from \FREESURFER{}'s toolkit, allows the conversion of these meshes in the form \STL{}. From \STL{} format via \CGAL{}, it become possible to build implicite functions in purpose to produice labeled  volumes. \\
Before selecting \CGAL{} to create implicit surafaces, tests were made with other algorithms. In particular, {\bf give the algorithm} used by \VTK{}. The results, {\bf show results} offer low efficiency and reliability. \\


\subsection{\CGAL{}}

CGAL is an Open Source Project providing access to efficient and reliable computationnal geometric algorithms written in C++ language. \CGAL{}, offers data structures and algorithms like triangulations, Voronoi diagrams, mesh generation, geometry processing (surface mesh simplification, subdivision and parameterization) , \dots %, interpolation (natural neighbor interpolation and placement of streamlines), shape analysis, fitting, and distances (smallest enclosing sphere of points or spheres, smallest enclosing ellipsoid of points, principal component analysis), and kinetic data structures.

All these data structures and algorithms operate on geometric objects like points and segments, and perform geometric tests on them. These objects and predicates are regrouped in CGAL Kernels.

Finally, the Support Library offers geometric object generators and spatial sorting functions, as well as a matrix search framework and a solver for linear and quadratic programs. It further offers interfaces to third party software such as the GUI libraries Qt, Geomview, and the Boost Graph Library. 

\subsubsection{Implicite surface}

This \CGAL{} component implements a surface reconstruction method which takes as input point sets with oriented normals and computes an implicit function. 

{\bf Laurent Rineau and Mariette Yvinec. A generic software design for Delaunay refinement meshing. Comput. Geom. Theory Appl., 38:100-110, 2007. }

Given a set of 3D points with oriented normals sampled on the {\bf to change: boundary of a 3D solid}, the Poisson Surface Reconstruction method solves for an approximate indicator function of the inferred solid, whose gradient best matches the input normals.

{\bf Michael Kazhdan, M. Bolitho, and Hugues Hoppe. Poisson Surface Reconstruction. In Symp. on Geometry Processing, pages 61-70, 2006.} 

%Cgal implements a variant of this algorithm which solves for a piecewise linear function on a 3D Delaunay triangulation instead of an adaptive octree. The algorithm takes as input a set of 3D oriented points. It builds a 3D Delaunay triangulation from these points and refines it by Delaunay refinement so as to remove all badly shaped (non isotropic) tetrahedra and to tessellate a loose bounding box of the input oriented points. The normal of each Steiner point added during refinement is set to zero. It then solves for a scalar indicator function f represented as a piecewise linear function over the refined triangulation. More specifically, it solves for the Poisson equation Δf = div(n) at each vertex of the triangulation using a sparse linear solver. Eventually, the Cgal surface mesh generator extracts an isosurface with function value set by default to be the median value of f at all input points. 


\subsubsection{Labeled volumes image}

{\bf intro from CGAL, voir s'il y a un article}\\
\FIJEE{} offers the possibility to create a representation of labeled volumes of a patient's head, in a completely automatic way. This image, in three dimensions and \INRIMAGE{}\footnote{http://serdis.dis.ulpgc.es/~krissian/InrView1/IOformat.html} format, is produced using implicit surfaces for the sclap, skull, \CSF{}, \GM{} and \WM{}. The subcortical parts of the image are extracted frome \texttt{aseg.nii} (\NIFTI{} format) a \FREESURFER{}'s output. \\
The image \INRIMAGE{} is provided as input to the \CGAL{}'s {\it oracle} for the production of three-dimensional volume meshes conforming different anatomical parts of the head.

\subsubsection{3D Mesh Generation}

The3D Mesh Generation is devoted to generate meshes discretizing 3D domains. The region may be connected or composed of multiple components and/or subdivided in several subdomains. \\
The meshing engine used in this mesh generator is based on Delaunay refinement.  [CDL07, CDR07]. The Delaunay refinement is followed by a mesh optimization phase to remove slivers and provide a good quality mesh. 

{\bf Jonathan R. Shewchuk. Tetrahedral mesh generation by Delaunay refinement. In Proc. 14th Annu. ACM Sympos. Comput. Geom., pages 86-95, 1998. }
{\bf S.-W. Cheng, T. K. Dey, and J. A. Levine. A practical delaunay meshing algorithm for a large class of domains. In Meshing Roundtable, pages 477-494, 2007. }

\paragraph{The meshing criteria}
{
The argument of type \texttt{MeshCriteria} passed to the mesh generator specifies the size and shape requirements for the tetrahedra in the mesh and for the triangles in the boundary surface mesh. These criteria condition the rules that drive the refinement process. \\
The criteria for surface facets are governed by the four following parameters:

\begin{itemize}
\item \texttt{facet\_angle}. This parameter controls the shape of surface facets. Actually, it is a lower bound for the angle (in degree) of surface facets. When boundary surfaces are smooth, the termination of the meshing process is guaranteed if the angular bound is at most 30 degrees.
\item \texttt{facet\_size} - controls the size of surface facets. 
\item \texttt{facet\_distance} - controls the approximation error of boundary and subdivision surfaces. 
\item \texttt{facet\_topology} - controls the set of topological constraints which have to be verified by each surface facet. By default, each vertex of a surface facet has to be located on a surface patch, on a curve segment, or on a corner. It can also be set to check whether the three vertices of a surface facet belongs to the same surface.
\end{itemize}

The criteria for mesh cells are governed by two parameters:

\begin{itemize}
\item \texttt{cell\_radius\_edge\_ratio} - controls the shape of mesh cells.
\item \texttt{cell\_size} - controls the size of mesh tetrahedra.
\end{itemize}
}

\paragraph{To review - High-Quality Consistent Meshing of Multi-Label Datasets}
{


require geometrically-accurate and topologically-correct models. 


While different strategies can be used to obtain realistic geometric models from labeled medical datasets, few of them offer sufficient flexibility: handling of data coming from different sources, control over the density and quality of the mesh elements. Also, most existing approaches have been designed to extract surface meshes corresponding to boundaries between labeled anatomical structures, hence necessitating post-processing steps to generate volume meshes needed by finite element methods.

 It offers easy control over the size and shape of mesh elements, for instance through a (possibly non-uniform) sizing field.

Our work builds on some recent provably correct Delaunay-based algorithms for meshing smooth surfaces [14] and volumes bounded by such surfaces [15]. These two algorithms are proven to terminate and to construct good-quality meshes, while offering bounds on the approximation accuracy of the original boundary and on the size of the output mesh. The refinement process is controlled by highly customizable quality criteria on triangular facets and on tetrahedra. A notable feature of the method of Boissonnat and Oudot [14] is that the surface needs only to be known through an {\it oracle}\footnote{The domain is input to the mesh generation function, as a domain class, often called the oracle, that provides predicates and constructors related to the domain, the subdomains, the boundary surface patches and also the 0 and 1-dimensional exposed features, if any. Mainly, the oracle provides a predicate to test if a given query point belongs to the domain or not and to find in which subdomain it lies in the affirmative case.} that, given a line segment, detects whether the segment intersects the surface and, in the affirmative, returns an intersection point. This makes the algorithm useful in a wide variety of contexts and for a large class of surfaces. Very recently, Oudot, Rineau and Yvinec [15] have proposed to combine the latter Delaunay-based surface mesher with a Delaunay refinement volume mesher [16].

Our work extends the method of Boissonnat and Oudot [14] and the method of Oudot, Rineau and Yvinec [15] to the case of multi-label partitions, so that they can be applied to the generation of high-quality geometric models from labeled medical datasets. To that end, we define a partition of Delaunay tetrahedra induced by a space subdivision. It is related to the concept of restricted Delaunay triangulation, borrowed from computational geometry. In our approach, the subdivision of the domain of interest is approximated by a discrete partition of the Delaunay tetrahedralization of a point set: each Delaunay tetrahedron is labeled with one adequate tissue type. Output surface meshes are composed of the triangular facets adjacent to two tetrahedra having different labels. The point set is iteratively refined until it forms a good sample of the boundaries between the different anatomical structures, and, if a quality volume mesh is desired, a good sample of their interior.

Another notable feature of our approach is that the continuous partition need not to be represented explicitly. It is known only through a {\it labeling oracle} that, given a point in space, answers which tissue it belongs to. This makes our approach applicable to virtually any combination of data sources, including labeled 3D images, polyhedral surfaces, unstructured volume meshes, fuzzy membership functions, possibly having different resolutions and different coordinate systems. The different data sources may even be inconsistent with each other due to noise or discretization artefacts. In this case, the {\it labeling oracle} has the responsibility of resolving the conflicts using some user defined rules. As a result, our meshing algorithm is not affected by the heterogeneity and possible inconsistency of the input datasets. Finally, another major advantage of our approach is that the customizable quality criteria on boundary facets and/or on tetrahedra can be tuned independently for the different anatomical structures.


Experiment 2: Non-uniform surface meshing. In the three following experiments, we use some segmented brain data which were automatically generated from a T1-weighted magnetic resonance (MR) image using FreeSurfer's Whole Brain Segmentation tool [25]. The second experiment demonstrates the ability of our algorithm to produce surface meshes with non-uniform resolution (Fig. 3-Right). The facet size criterion was chosen to be spatially-varying so that the occipital cortex would be more finely sampled than the frontal cortex. Although for clarity, only four surfaces are displayed (for each hemisphere, the cortical and cerebellum surfaces), a total number of 72 tissues were meshed using the aforementioned criteria.

}

\newpage

%-------------------------------------------------------------------------------

\section{To review}

\paragraph{Meshing Volumes Bounded by Piecewise Smooth Surfaces~\cite{LRineau2007}}{

La meilleure façon d'améliorer ce compromis est de créer un maillage avec des tailles d'éléments localement adaptés à la précision nécessaire. La forme des éléments d'un maillage simplicial est capitale, pour les applications de calcul. Dans les méthodes de résolution approchée d'équations différentielles, à la fois les grands angles et les petits angles doivent être évités [She02b, She]. L'erreur d'approximation de la solution dépend principalement de la taille des éléments. Cependant, pour une taille d'éléments donnée, la présence de grands angles dans le maillage augmente l'erreur d'approximation du gradient de la solution. Si certains angles sont proches de 180°, il se peut aussi que la méthode de calcul ne converge pas vers la solution [BA76]. Les petits angles, ainsi que les grands angles, dégradent le conditionnement du problème numérique, c'est-à-dire la stabilité de la solution par rapport aux erreurs d'arrondis du calcul. 


}



